{% load static %}
<div class="app-header header top-header lhtheader">
    <div class="container-fluid main-container">
        <div class="d-flex">
            <div class="dropdown side-nav">
                <div class="app-sidebar__toggle" data-bs-toggle="sidebar">
                    <a class="open-toggle" href="javascript:void(0)">
                        <svg class="header-icon"
                             xmlns="http://www.w3.org/2000/svg"
                             width="24"
                             height="24"
                             viewBox="0 0 24 24"
                             fill="none"
                             stroke="currentColor"
                             stroke-width="2"
                             stroke-linecap="round"
                             stroke-linejoin="round">
                            <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </a>
                    <a class="close-toggle" href="javascript:void(0)">
                        <svg class="header-icon"
                             xmlns="http://www.w3.org/2000/svg"
                             height="24"
                             viewBox="0 0 24 24"
                             width="24">
                            <path d="M0 0h24v24H0V0z" fill="none" />
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z" />
                        </svg>
                    </a>
                </div>
            </div>
            <a class="header-brand" href="index">
                <img src="{% static 'interface_administration/assets/images/brand/logo.png' %}"
                     class="header-brand-img desktop-lgo"
                     alt="Dashtic logo">
                <img src="{% static 'interface_administration/assets/images/brand/logo1.png' %}"
                     class="header-brand-img dark-logo"
                     alt="Dashtic logo">
                <img src="{% static 'interface_administration/assets/images/brand/favicon.png' %}"
                     class="header-brand-img mobile-logo"
                     alt="Dashtic logo">
                <img src="{% static 'interface_administration/assets/images/brand/favicon1.png' %}"
                     class="header-brand-img darkmobile-logo"
                     alt="Dashtic logo">
            </a>
            {%if audience == "true"  %}
            <a href="#sexe" class="nav-link icon p-0">
                <span class="nav-span">Sexe</span>
            </a>
            <a href="#demographie" class="nav-link icon p-0">
                <span class="nav-span">Démographie</span>
            </a>
            <a href="#ageetsexe" class="nav-link icon p-0">
                <span class="nav-span">Age et sexe</span>
            </a>
            <a href="#langue" class="nav-link icon p-0">
                <span class="nav-span">Langue</span>
            </a>
            <a href="#source" class="nav-link icon p-0">
                <span class="nav-span">Source des clics</span>
            </a>
            {%endif%}
            <div class="d-flex order-lg-2 ms-lg-auto">
                <button class="navbar-toggler navresponsive-toggler d-lg-none"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent-4"
                        aria-controls="navbarSupportedContent-4"
                        aria-expanded="false"
                        aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon fe fe-more-vertical "></span>
                </button>
                <div class="navbar navbar-expand-lg navbar-nav-right responsive-navbar navbar-dark p-0">
                    <div class="collapse navbar-collapse" id="navbarSupportedContent-4">
                        <div class="d-flex">
                            <a href="javascript:void(0)"
                               data-bs-toggle="search"
                               class="nav-link nav-link-lg d-lg-none navsearch">
                                <svg class="header-icon search-icon"
                                     x="1008"
                                     y="1248"
                                     viewBox="0 0 24 24"
                                     height="100%"
                                     width="100%"
                                     preserveAspectRatio="xMidYMid meet"
                                     focusable="false">
                                    <path d="M0 0h24v24H0V0z" fill="none" />
                                    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                                </svg>
                            </a>
                            <!-- SEARCH -->
                            <div class="dropdown header-theme">
                                <a class="nav-link icon layout-setting">
                                    <span class="dark-layout">
                                        <svg class="header-icon"
                                             xmlns="http://www.w3.org/2000/svg"
                                             enable-background="new 0 0 24 24"
                                             height="24px"
                                             viewBox="0 0 24 24"
                                             width="24px"
                                             fill="#000000">
                                            <rect fill="none" height="24" width="24" /><circle cx="12" cy="12" opacity=".3" r="3" />
                                            <path d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z" />
                                        </svg>
                                    </span>
                                    <span class="light-layout">
                                        <svg class="header-icon"
                                             xmlns="http://www.w3.org/2000/svg"
                                             enable-background="new 0 0 24 24"
                                             height="24px"
                                             viewBox="0 0 24 24"
                                             width="24px"
                                             fill="#000000">
                                            <rect fill="none" height="24" width="24" />
                                            <path d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27 C17.45,17.19,14.93,19,12,19c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z" opacity=".3" />
                                            <path d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z" />
                                        </svg>
                                    </span>
                                </a>
                            </div>
                            <div class="dropdown header-notify">
                                <a class="nav-link icon" data-bs-toggle="dropdown">
                                    <svg class="header-icon select_icon"
                                         x="1008"
                                         y="1248"
                                         viewBox="0 0 24 24"
                                         height="100%"
                                         width="100%"
                                         preserveAspectRatio="xMidYMid meet"
                                         focusable="false">
                                        <path opacity=".3" d="M12 6.5c-2.49 0-4 2.02-4 4.5v6h8v-6c0-2.48-1.51-4.5-4-4.5z"></path>
                                        <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-11c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2v-5zm-2 6H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6zM7.58 4.08L6.15 2.65C3.75 4.48 2.17 7.3 2.03 10.5h2a8.445 8.445 0 013.55-6.42zm12.39 6.42h2c-.15-3.2-1.73-6.02-4.12-7.85l-1.42 1.43a8.495 8.495 0 013.54 6.42z">
                                        </path>
                                    </svg>
                                    <span class="place_badge"></span>
                                </a>
                                <div class="notificationpush dropdown-menu dropdown-menu-end dropdown-menu-arrow  animated">
                                    {%for notification in notifications%}
                                    <a  {% if not notification.is_read %} active href="{{notification.destination_url}}?read_notification=true&&notification={{notification.id}}" {%else%} href="{{notification.destination_url}}" {%endif%} class="dropdown-item d-flex pb-3">
                                        <svg  class="header-icon me-4"
                                             x="1008"
                                             y="1248"
                                             viewBox="0 0 24 24"
                                             height="100%"
                                             width="100%"
                                             preserveAspectRatio="xMidYMid meet"
                                             focusable="false" >
                                            </style>
                                             <path {% if not notification.is_read %}style="fill:blue;"{%else%}style="fill:green;"{% endif %} d="M14.38,3.467l0.232-0.633c0.086-0.226-0.031-0.477-0.264-0.559c-0.229-0.081-0.48,0.033-0.562,0.262l-0.234,0.631C10.695,2.38,7.648,3.89,6.616,6.689l-1.447,3.93l-2.664,1.227c-0.354,0.166-0.337,0.672,0.035,0.805l4.811,1.729c-0.19,1.119,0.445,2.25,1.561,2.65c1.119,0.402,2.341-0.059,2.923-1.039l4.811,1.73c0,0.002,0.002,0.002,0.002,0.002c0.23,0.082,0.484-0.033,0.568-0.262c0.049-0.129,0.029-0.266-0.041-0.377l-1.219-2.586l1.447-3.932C18.435,7.768,17.085,4.676,14.38,3.467 M9.215,16.211c-0.658-0.234-1.054-0.869-1.014-1.523l2.784,0.998C10.588,16.215,9.871,16.447,9.215,16.211 M16.573,10.27l-1.51,4.1c-0.041,0.107-0.037,0.227,0.012,0.33l0.871,1.844l-4.184-1.506l-3.734-1.342l-4.185-1.504l1.864-0.857c0.104-0.049,0.188-0.139,0.229-0.248l1.51-4.098c0.916-2.487,3.708-3.773,6.222-2.868C16.187,5.024,17.489,7.783,16.573,10.27"></path>
                                        </svg>
                                        <div class="header-dropdown-msg">
                                            <div class="font-weight-bold">{{notification.content}}</div>
                                            <div class="small text-muted">il y a {{notification.created_at|timesince}}</div>
                                        </div>
                                        {% if notification.is_read %}
                                        <i class="fa fa-check text-success"></i>
                                        {%else %}
                                        <i class="fa fa-circle text-primary"></i>
                                        {% endif %}
                                    </a>
                                    {%endfor%}
                                    <div class=" text-center p-2 border-top">
                                        <a href="{%url 'administration:notifications'%}" class="">View All Notifications</a>
                                    </div>
                                </div>
                            </div>
                            <div class="dropdown profile-dropdown">
                                <a href="javascript:void(0)"
                                   class="nav-link icon leading-none"
                                   data-bs-toggle="dropdown">
                                    <span>
                                            <img src="{% static 'interface_administration/assets/images/users/profil.png' %}"
                                                 alt="img"
                                                 class="avatar avatar-md brround">
                                    </span>
                                </a>
                                <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow animated">
                                    <div class="text-center">
                                            <a href="javascript:void(0)"
                                               class="dropdown-item text-center user pb-0 font-weight-bold">{{request.user.username}}</a>
                                        <div class="dropdown-divider"></div>
                                    </div>
                                    <a class="dropdown-item d-flex" href="/accounts/logout/">
                                        <svg class="header-icon me-3"
                                             x="1008"
                                             y="1248"
                                             viewBox="0 0 24 24"
                                             height="100%"
                                             width="100%"
                                             preserveAspectRatio="xMidYMid meet"
                                             focusable="false">
                                            <path d="M0 0h24v24H0V0zm0 0h24v24H0V0z" fill="none" />
                                            <path d="M6 20h12V10H6v10zm2-6h3v-3h2v3h3v2h-3v3h-2v-3H8v-2z" opacity=".3" />
                                            <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM8.9 6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H8.9V6zM18 20H6V10h12v10zm-7-1h2v-3h3v-2h-3v-3h-2v3H8v2h3z" />
                                        </svg>
                                        <div class="mt-1 header-dropdown-msg">Se déconnecter</div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function switchUser(user) {
        const encodedUser = encodeURIComponent(user);
        const url = `/switch/${encodedUser}/`;
        const xmlhttp = new XMLHttpRequest();
    
        xmlhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                const response = JSON.parse(this.responseText);
                if(response.message=="Utilisateur enregistré avec succès")
                {
                    window.location.href="/";
                }
            }
        }
    
        xmlhttp.open("GET", url);
        xmlhttp.send();
    }
    
</script>
